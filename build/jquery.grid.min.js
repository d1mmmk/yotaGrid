/*! yota 2014-10-08 */
!function(a,b){"use strict";function c(a,b){return this.init(a,b),this.api}var d={};d.observer=function(){this._fns=[]},d.observer.prototype={subscribe:function(a){return"function"==typeof a&&this._fns.push(a)},fire:function(a){for(var b=this._fns.length-1;b>=0;b--)this._fns[b](a)}},d.tmpl=function(a,b){if("function"==typeof a)return a(b);for(var c in b)b.hasOwnProperty(c)&&(a=a.replace(new RegExp("\\$\\{"+c+"\\}","gi"),b[c]));return a},c.prototype={init:function(a,b){return this.element=a,this.view=b.view,this.onChange=b.view.onChange(),this.subscribe(),this.render(),this.initApi()},render:function(){var a;return"function"==typeof this.view.render&&(a=this.view.render()),this.element.innerHTML=a,a},subscribe:function(){var a=this;this.onChange.subscribe(function(){return a.render()})},initApi:function(){var a=this;return this.api={render:function(){return a.render(arguments)}},this}},a.fn.jGrid=function(b){return a(this).each(function(){var d=this,e=a(d).data("jGrid");return"undefined"==typeof e&&a(d).data("jGrid",e=new c(d,b)),e}),a(this)};var e=b.Model=function(a){return this.init(a),this.api};e.prototype={init:function(a){return this.data=[],this.addData(a),this.collectDataTimer=null,this.collectDataArray=[],this.onChange=new d.observer,this.initApi()},addData:function(a,b){for(var c=0;c<=a.length-1;c++)this.addDataRow(a[c]);return this.updateIndex(b)},addDataRow:function(a){var b={};switch(typeof a){case"string":b={title:"",data:a};break;default:b={title:a.hasOwnProperty("title")?a.title:"",data:a.hasOwnProperty("data")?a.data:""}}return this.data.push(b)},collectData:function(a){var b=this;clearTimeout(this.collectDataTimer),arguments.length>1?a={data:Array.prototype.slice.call(arguments).split(", ")}:"string"==typeof a&&(a=[a]),this.collectDataArray.push(a),this.collectDataTimer=setTimeout(function(){var a=b.collectDataArray.slice(0);b.collectDataArray=[],b.addData(a,function(){b.onChange.fire(b.data)})},1)},updateIndex:function(a){for(var b=this.data.length-1;b>=0;b--)this.data[b].id=b;return"function"==typeof a&&a()},initApi:function(){var a=this;this.api={add:function(b){return a.collectData(b)},getData:function(){return a.data},onChange:function(){return a.onChange}}}};var f=b.View=function(a){return this.init(a),this.api};f.prototype={init:function(a){return this.model=a,this.data=this.model.getData(),this.onDataChange=this.model.onChange(),this.onChange=new d.observer,this.colNames=["id","Title","Data"],this.preRender(),this.subscribe(),this.initApi()},preRender:function(){for(var a="",b=0;b<=this.colNames.length-1;b++)a+="<th>"+this.colNames[b]+"</th>";a="<tr>"+a+"</tr>",this.tHead="<thead>"+a+"</thead>",this.tFooter="<tfoot>"+a+"</tfoot>"},renderRow:function(a){return"<tr><td>"+a.id+"</td><td>"+a.title+"</td><td>"+a.data+"</td></tr>"},render:function(){var a="";if(!this.data)return"empty data";var b=this.data.length+" rows";console.time(b);for(var c=0;c<=this.data.length-1;c++)a+=this.renderRow(this.data[c]);return a="<tboby>"+a+"</tboby>",console.timeEnd(b),"<table>"+this.tHead+this.tFooter+a+"</table>"},onChange:function(a){this.data=a},subscribe:function(){var a=this;this.onDataChange.subscribe(function(b){a.onChange.fire(b)})},initApi:function(){var a=this;this.api={render:function(){return a.render(arguments)},onChange:function(){return a.onChange}}}}}(jQuery,window);